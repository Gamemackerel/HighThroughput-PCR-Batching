<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: ClusterGraphMethods
  
    &mdash; Documentation by YARD 0.9.16
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "ClusterGraphMethods";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (C)</a> &raquo;
    
    
    <span class="title">ClusterGraphMethods</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: ClusterGraphMethods
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="ExtensionClusterGraph.html" title="ExtensionClusterGraph (class)">ExtensionClusterGraph</a></span>, <span class='object_link'><a href="TannealClusterGraph.html" title="TannealClusterGraph (class)">TannealClusterGraph</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/pcr_batching_representation.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Core clustering logic that is used for both ExtensionClusterGraph and
TannealClusterGraph to group a set of objects based on the relative
proximity of their fields</p>

<p>representation invariants of cluster graphs:</p>

<pre class="code ruby"><code class="ruby">initial size of pcr_operations == clusters.map { members }.flatten.size
Set(pcr_operations) == Set(clusters.map { members }.flatten)
pcr operations belong to exactly 1 cluster</code></pre>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#checkrep-instance_method" title="#checkrep (instance method)">#<strong>checkrep</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cluster_set-instance_method" title="#cluster_set (instance method)">#<strong>cluster_set</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>When using lazy combination, the adjacency list graph representation may
have duplicate clusters, or clusters which have already been swallowed by a
larger one.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#combine_nearest_clusters_lazy-instance_method" title="#combine_nearest_clusters_lazy (instance method)">#<strong>combine_nearest_clusters_lazy</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Remove the shortest distance edge and combine the cluster pair into one
cluster if one or both of the cluster pair has already been combined,
update the edge entry  to reflect the highest level cluster that they now
constitute.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#max_distance-instance_method" title="#max_distance (instance method)">#<strong>max_distance</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Gets Float value which represents an impossible combination distance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#perform_clustering-instance_method" title="#perform_clustering (instance method)">#<strong>perform_clustering</strong>(with_checkrep)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>combines nearest clusters until threshold function is triggered modifies
the state of the graph, and returns the resulting set of clusters.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_s-instance_method" title="#to_s (instance method)">#<strong>to_s</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="checkrep-instance_method">
  
    #<strong>checkrep</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


128
129
130
131
132
133</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/pcr_batching_representation.rb', line 128</span>

<span class='kw'>def</span> <span class='id identifier rubyid_checkrep'>checkrep</span>
    <span class='id identifier rubyid_clusters'>clusters</span> <span class='op'>=</span> <span class='id identifier rubyid_cluster_set'>cluster_set</span>
    <span class='id identifier rubyid_total_pcr_members'>total_pcr_members</span> <span class='op'>=</span> <span class='id identifier rubyid_clusters'>clusters</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_members'>members</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='id identifier rubyid_assert'>assert</span> <span class='id identifier rubyid_total_pcr_members'>total_pcr_members</span> <span class='op'>==</span> <span class='ivar'>@initial_size</span>
    <span class='id identifier rubyid_assert'>assert</span> <span class='ivar'>@pcr_operations</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span> <span class='op'>==</span> <span class='id identifier rubyid_clusters'>clusters</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_c'>c</span><span class='op'>|</span> <span class='id identifier rubyid_c'>c</span><span class='period'>.</span><span class='id identifier rubyid_members'>members</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="cluster_set-instance_method">
  
    #<strong>cluster_set</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>When using lazy combination, the adjacency list graph representation may
have duplicate clusters, or clusters which have already been swallowed by a
larger one. `cluster_set` returns only the  most current, highest level
graph nodes</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


111
112
113
114
115
116
117
118
119
120</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/pcr_batching_representation.rb', line 111</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cluster_set'>cluster_set</span>
    <span class='id identifier rubyid_clusters'>clusters</span> <span class='op'>=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_clusters'>clusters</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@final_cluster</span> <span class='kw'>if</span> <span class='ivar'>@final_cluster</span>
    <span class='ivar'>@adjacency_list</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cluster_tuple'>cluster_tuple</span><span class='comma'>,</span> <span class='id identifier rubyid_priority'>priority</span><span class='op'>|</span>
        <span class='id identifier rubyid_cluster_tuple'>cluster_tuple</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_cluster'>cluster</span><span class='op'>|</span>
            <span class='id identifier rubyid_clusters'>clusters</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_cluster'>cluster</span><span class='period'>.</span><span class='id identifier rubyid_get_containing_supercluster'>get_containing_supercluster</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_clusters'>clusters</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="combine_nearest_clusters_lazy-instance_method">
  
    #<strong>combine_nearest_clusters_lazy</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Remove the shortest distance edge and combine the cluster pair into one
cluster if one or both of the cluster pair has already been combined,
update the edge entry  to reflect the highest level cluster that they now
constitute</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/pcr_batching_representation.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_combine_nearest_clusters_lazy'>combine_nearest_clusters_lazy</span>
    <span class='id identifier rubyid_pair'>pair</span> <span class='op'>=</span> <span class='ivar'>@adjacency_list</span><span class='period'>.</span><span class='id identifier rubyid_delete_min_return_key'>delete_min_return_key</span>
    <span class='id identifier rubyid_cluster_a'>cluster_a</span><span class='comma'>,</span> <span class='id identifier rubyid_cluster_b'>cluster_b</span> <span class='op'>=</span> <span class='id identifier rubyid_pair'>pair</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_cluster_a'>cluster_a</span><span class='period'>.</span><span class='id identifier rubyid_child_cluster'>child_cluster</span> <span class='op'>||</span> <span class='id identifier rubyid_cluster_b'>cluster_b</span><span class='period'>.</span><span class='id identifier rubyid_child_cluster'>child_cluster</span> 
        <span class='comment'># at least one of these clusters have been merged 
</span>        <span class='comment'># so we must update this adjacency list entry without combining them
</span>        <span class='id identifier rubyid_a_super'>a_super</span> <span class='op'>=</span> <span class='id identifier rubyid_cluster_a'>cluster_a</span><span class='period'>.</span><span class='id identifier rubyid_get_containing_supercluster'>get_containing_supercluster</span>
        <span class='id identifier rubyid_b_super'>b_super</span> <span class='op'>=</span> <span class='id identifier rubyid_cluster_b'>cluster_b</span><span class='period'>.</span><span class='id identifier rubyid_get_containing_supercluster'>get_containing_supercluster</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_a_super'>a_super</span> <span class='op'>!=</span> <span class='id identifier rubyid_b_super'>b_super</span>
            <span class='ivar'>@adjacency_list</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='const'>Set</span><span class='lbracket'>[</span><span class='id identifier rubyid_a_super'>a_super</span><span class='comma'>,</span> <span class='id identifier rubyid_b_super'>b_super</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_distance_func'>distance_func</span><span class='lparen'>(</span><span class='id identifier rubyid_a_super'>a_super</span><span class='comma'>,</span> <span class='id identifier rubyid_b_super'>b_super</span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='kw'>else</span>
        <span class='ivar'>@size</span> <span class='op'>-=</span> <span class='int'>1</span>
        <span class='id identifier rubyid_cluster_ab'>cluster_ab</span> <span class='op'>=</span> <span class='id identifier rubyid_cluster_a'>cluster_a</span><span class='period'>.</span><span class='id identifier rubyid_combine_with'>combine_with</span><span class='lparen'>(</span><span class='id identifier rubyid_cluster_b'>cluster_b</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='ivar'>@adjacency_list</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
        <span class='ivar'>@final_cluster</span> <span class='op'>=</span> <span class='id identifier rubyid_cluster_ab'>cluster_ab</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="max_distance-instance_method">
  
    #<strong>max_distance</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Gets Float value which represents an impossible combination distance.
Float::MAX cannot be used for this value, since it is critical to prims</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


124
125
126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/pcr_batching_representation.rb', line 124</span>

<span class='kw'>def</span> <span class='id identifier rubyid_max_distance'>max_distance</span>
    <span class='lparen'>(</span><span class='const'>Float</span><span class='op'>::</span><span class='const'>MAX</span> <span class='op'>-</span> <span class='int'>1</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="perform_clustering-instance_method">
  
    #<strong>perform_clustering</strong>(with_checkrep)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>combines nearest clusters until threshold function is triggered modifies
the state of the graph, and returns the resulting set of clusters</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


75
76
77
78
79
80
81</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/pcr_batching_representation.rb', line 75</span>

<span class='kw'>def</span> <span class='id identifier rubyid_perform_clustering'>perform_clustering</span> <span class='id identifier rubyid_with_checkrep'>with_checkrep</span>
    <span class='kw'>while</span> <span class='op'>!</span><span class='id identifier rubyid_threshhold_func'>threshhold_func</span>
        <span class='id identifier rubyid_combine_nearest_clusters_lazy'>combine_nearest_clusters_lazy</span>
        <span class='id identifier rubyid_checkrep'>checkrep</span> <span class='kw'>if</span> <span class='id identifier rubyid_with_checkrep'>with_checkrep</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_cluster_set'>cluster_set</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_s-instance_method">
  
    #<strong>to_s</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


135
136
137</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/pcr_batching_representation.rb', line 135</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_s'>to_s</span> 
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>size:</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='ivar'>@size</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>clusters: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_cluster_set'>cluster_set</span><span class='period'>.</span><span class='id identifier rubyid_to_a'>to_a</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Sat Dec 22 16:44:38 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.16 (ruby-2.3.7).
</div>

    </div>
  </body>
</html>